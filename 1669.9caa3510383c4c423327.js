(self.webpackChunkcovin_staff_app=self.webpackChunkcovin_staff_app||[]).push([[1669],{5310:(e,t,n)=>{"use strict";var s;n.d(t,{Uw:()=>l,fo:()=>a}),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global,function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(s||(s={}));class o extends Error{constructor(e,t){super(e),this.message=e,this.code=t}}const i=e=>{var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"},r=(e=>e.Capacitor=(e=>{var t,n,r,a,l;const c=e.Capacitor||{},d=c.Plugins=c.Plugins||{},u=e.CapacitorPlatforms,p=(null===(t=null==u?void 0:u.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>i(e)),g=(null===(n=null==u?void 0:u.currentPlatform)||void 0===n?void 0:n.isNativePlatform)||(()=>"web"!==i(e)),h=(null===(r=null==u?void 0:u.currentPlatform)||void 0===r?void 0:r.isPluginAvailable)||(e=>{const t=m.get(e);return!!(null==t?void 0:t.platforms.has(p()))||!!f(e)}),f=(null===(a=null==u?void 0:u.currentPlatform)||void 0===a?void 0:a.getPluginHeader)||(e=>{var t;return null===(t=c.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)}),m=new Map,v=(null===(l=null==u?void 0:u.currentPlatform)||void 0===l?void 0:l.registerPlugin)||((e,t={})=>{const n=m.get(e);if(n)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),n.proxy;const i=p(),r=f(e);let a;const l=n=>{let l;const d=(...d)=>{const u=(async()=>(!a&&i in t&&(a=a="function"==typeof t[i]?await t[i]():t[i]),a))().then(t=>{const a=((t,n)=>{var a,l;if(!r){if(t)return null===(l=t[n])||void 0===l?void 0:l.bind(t);throw new o(`"${e}" plugin is not implemented on ${i}`,s.Unimplemented)}{const s=null==r?void 0:r.methods.find(e=>n===e.name);if(s)return"promise"===s.rtype?t=>c.nativePromise(e,n.toString(),t):(t,s)=>c.nativeCallback(e,n.toString(),t,s);if(t)return null===(a=t[n])||void 0===a?void 0:a.bind(t)}})(t,n);if(a){const e=a(...d);return l=null==e?void 0:e.remove,e}throw new o(`"${e}.${n}()" is not implemented on ${i}`,s.Unimplemented)});return"addListener"===n&&(u.remove=async()=>l()),u};return d.toString=()=>`${n.toString()}() { [capacitor code] }`,Object.defineProperty(d,"name",{value:n,writable:!1,configurable:!1}),d},u=l("addListener"),g=l("removeListener"),h=(e,t)=>{const n=u({eventName:e},t),s=async()=>{const s=await n;g({eventName:e,callbackId:s},t)},o=new Promise(e=>n.then(()=>e({remove:s})));return o.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await s()},o},v=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"addListener":return r?h:u;case"removeListener":return g;default:return l(t)}}});return d[e]=v,m.set(e,{name:e,proxy:v,platforms:new Set([...Object.keys(t),...r?[i]:[]])}),v});return c.convertFileSrc||(c.convertFileSrc=e=>e),c.getPlatform=p,c.handleError=t=>e.console.error(t),c.isNativePlatform=g,c.isPluginAvailable=h,c.pluginMethodNoop=(e,t,n)=>Promise.reject(`${n} does not have an implementation of "${t}".`),c.registerPlugin=v,c.Exception=o,c.DEBUG=!!c.DEBUG,c.isLoggingEnabled=!!c.isLoggingEnabled,c.platform=c.getPlatform(),c.isNative=c.isNativePlatform(),c})(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),a=r.registerPlugin;class l{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);const s=async()=>this.removeListener(e,t),o=Promise.resolve({remove:s});return Object.defineProperty(o,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await s()}}),o}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){const n=this.listeners[e];n&&n.forEach(e=>e(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new r.Exception(e,s.Unimplemented)}unavailable(e="not available"){return new r.Exception(e,s.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const s=n.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}},1669:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VerifyPassPageModule:()=>w});var s=n(1116),o=n(1462),i=n(6611),r=n(5860);function a(e,t,n,s){return new(n||(n=Promise))(function(o,i){function r(e){try{l(s.next(e))}catch(t){i(t)}}function a(e){try{l(s.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,a)}l((s=s.apply(e,t||[])).next())})}var l,c=n(5310);!function(e){e.UPC_A="UPC_A",e.UPC_E="UPC_E",e.UPC_EAN_EXTENSION="UPC_EAN_EXTENSION",e.EAN_8="EAN_8",e.EAN_13="EAN_13",e.CODE_39="CODE_39",e.CODE_39_MOD_43="CODE_39_MOD_43",e.CODE_93="CODE_93",e.CODE_128="CODE_128",e.CODABAR="CODABAR",e.ITF="ITF",e.ITF_14="ITF_14",e.AZTEC="AZTEC",e.DATA_MATRIX="DATA_MATRIX",e.MAXICODE="MAXICODE",e.PDF_417="PDF_417",e.QR_CODE="QR_CODE",e.RSS_14="RSS_14",e.RSS_EXPANDED="RSS_EXPANDED"}(l||(l={}));const d=(0,c.fo)("BarcodeScanner",{web:()=>n.e(4256).then(n.bind(n,4256)).then(e=>new e.BarcodeScannerWeb)});var u=n(2693),p=n(529),g=n(8619);const h=function(){return{standalone:!0}};function f(e,t){if(1&e){const e=g.EpF();g.ynx(0,7),g.TgZ(1,"ion-card",8),g.TgZ(2,"ion-card-header"),g.TgZ(3,"ion-card-title"),g._uU(4,"Scan QR token"),g.qZA(),g.qZA(),g.TgZ(5,"ion-card-content"),g.TgZ(6,"ion-button",9),g.NdJ("click",function(){return g.CHM(e),g.oxw().startScanner()}),g._UZ(7,"ion-icon",10),g._uU(8," Start Scan "),g.qZA(),g.qZA(),g.TgZ(9,"p",11),g._uU(10),g.qZA(),g.qZA(),g.TgZ(11,"p",11),g.TgZ(12,"i"),g._uU(13,"or"),g.qZA(),g.qZA(),g.TgZ(14,"ion-card",8),g.TgZ(15,"ion-card-header"),g.TgZ(16,"ion-card-title"),g._uU(17,"Enter token manually"),g.qZA(),g.qZA(),g.TgZ(18,"ion-card-content"),g.TgZ(19,"ion-item"),g.TgZ(20,"ion-input",12),g.NdJ("ngModelChange",function(t){return g.CHM(e),g.oxw().passNum.token=t}),g.qZA(),g.qZA(),g.TgZ(21,"ion-button",13),g.NdJ("click",function(){return g.CHM(e),g.oxw().checkPass()}),g._uU(22,"Check!"),g.qZA(),g.qZA(),g.qZA(),g.BQk()}if(2&e){const e=g.oxw();g.xp6(10),g.Oqu(e.result),g.xp6(10),g.Q6J("ngModel",e.passNum.token)("ngModelOptions",g.DdM(3,h))}}const m=[{path:"",component:(()=>{class e{constructor(e,t){this.alertCtrl=e,this.http=t,this.result=null,this.scanActive=!1,this.x=new Date,this.dateString=this.x.getDate()+"0"+(this.x.getMonth()+1)+this.x.getFullYear()+"-",this.passNum={token:this.dateString+""}}ngOnInit(){d.prepare()}ngOnDestroy(){d.stopScan(),this.scanActive=!1,d.showBackground()}checkPass(){if(this.passNum.token=this.passNum.token,this.passNum.token.toString().length<8)this.alertCtrl.create({header:"Error",message:"Invalid Token",buttons:["Try again"]}).then(e=>e.present());else{const e=new u.WM({"Content-Type":"application/json",Authorization:"Token "+JSON.parse(localStorage.staff_details).token});this.http.get(`${p.N.BASE_SERVICE_URL}/staffserver/validate-token/${this.passNum.token.toString()}`,{headers:e}).subscribe(e=>{"token found"===e.status?this.alertCtrl.create({cssClass:"token-alert",header:"Success",message:`\n                        <h4>${e.status.toUpperCase()}</h4>\n                        <table>\n                          <tr>\n                            <td>Name: </td>\n                            <td>${e.name}</td>\n                          </tr>\n                          <tr>\n                            <td>Vaccine type: </td>\n                            <td>${e.vaccine_type}</td>\n                          </tr>\n                          <tr>\n                            <td>Dose: </td>\n                            <td>${e.dose}</td>\n                          </tr>\n                          <tr>\n                            <td>Age-group:</td>\n                            <td>${e.age}</td>\n                          </tr>\n                        </table>\n                        <p>\n                          <strong>Token Last used:</strong>\n                          <i>Not used yet</i>\n                        </p>\n                  `,buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Use Token",handler:()=>{this.useToken()}}]}).then(e=>e.present()):"Token Used"===e.status?(console.log(e),this.alertCtrl.create({cssClass:"token-alert",header:"Success",message:`\n                      <h4>${e.status.toUpperCase()}</h4>\n                      <table>\n                          <tr>\n                            <td>Name: </td>\n                            <td>${e.name}</td>\n                          </tr>\n                          <tr>\n                            <td>Vaccine type: </td>\n                            <td>${e.vaccine_type}</td>\n                          </tr>\n                          <tr>\n                            <td>Dose: </td>\n                            <td>${e.dose}</td>\n                          </tr>\n                          <tr>\n                            <td>Age-group:</td>\n                            <td>${e.age}</td>\n                          </tr>\n                        </table>\n                        <p>\n                          <b>Token Last used:</b>\n                          <p>${e.used_time}</p>\n                        </p>\n                `,buttons:[{text:"OK"}]}).then(e=>e.present())):this.alertCtrl.create({header:"Error",message:"Token not found",buttons:["Try again"]}).then(e=>e.present())},e=>{console.log(e)})}}useToken(){console.log("Token info, ",this.passNum.token);const e=new u.WM({"Content-Type":"application/json",Authorization:"Token "+JSON.parse(localStorage.staff_details).token});this.http.get(`${p.N.BASE_SERVICE_URL}/staffserver/use-token/${this.passNum.token.toString()}`,{headers:e}).subscribe(e=>{"Success"===e.status&&this.alertCtrl.create({header:"Success",message:`\n                    ${e.status.toUpperCase()}\n                    Token Used Successfully.\n              `,buttons:[{text:"OK"}]}).then(e=>e.present())})}startScanner(){return a(this,void 0,void 0,function*(){if(yield this.checkPermission()){this.scanActive=!0,d.hideBackground();const e=yield d.startScan();e.hasContent?(this.result=e.content,this.passNum.token=e.content,this.scanActive=!1,console.log("scan result",this.result),console.log("token result",this.passNum.token)):console.log("Error")}console.log("scan started")})}checkPermission(){return a(this,void 0,void 0,function*(){return new Promise((e,t)=>a(this,void 0,void 0,function*(){const t=yield d.checkPermission({force:!0});if(t.granted)e(!0);else if(t.denied){const t=yield this.alertCtrl.create({header:"No permission",message:"Please allow camera access in your settings",buttons:[{text:"No",role:"cancel"},{text:"Open Settings",handler:()=>{e(!1),d.openAppSettings()}}]});yield t.present()}}))})}stopScanner(){this.scanActive=!1,d.showBackground(),d.stopScan()}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(i.Br),g.Y36(u.eN))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-verify-pass"]],decls:13,vars:6,consts:[[2,"margin-top","3.5em",3,"hidden"],["slot","start"],["class","ver-pass",4,"ngIf"],[1,"scanner-buttons",3,"hidden"],[1,"ion-no-padding"],["expand","full",3,"click"],[1,"scan-box",3,"hidden"],[1,"ver-pass"],[1,"ion-activated"],["expand","block",3,"click"],["name","scan","slot","start"],[1,"ion-text-center"],["type","text","placeholder","Enter the token number","required","","maxlength","80",3,"ngModel","ngModelOptions","ngModelChange"],["expand","block","color","success",1,"ion-margin-top",3,"click"]],template:function(e,t){1&e&&(g.TgZ(0,"ion-header",0),g.TgZ(1,"ion-toolbar"),g.TgZ(2,"ion-buttons",1),g._UZ(3,"ion-back-button"),g.qZA(),g.TgZ(4,"ion-title"),g._uU(5,"verify-pass"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(6,"ion-content"),g.YNc(7,f,23,4,"ng-container",2),g.TgZ(8,"ion-row",3),g.TgZ(9,"ion-col",4),g.TgZ(10,"ion-button",5),g.NdJ("click",function(){return t.stopScanner()}),g._uU(11,"Stop Scanning"),g.qZA(),g.qZA(),g.qZA(),g._UZ(12,"div",6),g.qZA()),2&e&&(g.Q6J("hidden",t.scanActive),g.xp6(6),g.Udp("--background",t.scanActive?"#00000000":"#fff"),g.xp6(1),g.Q6J("ngIf",!t.scanActive),g.xp6(1),g.Q6J("hidden",!t.scanActive),g.xp6(4),g.Q6J("hidden",!t.scanActive))},directives:[i.Gu,i.sr,i.Sm,i.oU,i.cs,i.wd,i.W2,s.O5,i.Nd,i.wI,i.YG,i.PM,i.Zi,i.gZ,i.FN,i.gu,i.Ie,i.pK,i.j9,o.Q7,o.nD,o.JJ,o.On],styles:['.ver-pass[_ngcontent-%COMP%]{transition:all .2s}.scanner-buttons[_ngcontent-%COMP%]{margin:0 auto;position:absolute;bottom:10%;left:8%;width:85%;z-index:11}.scan-box[_ngcontent-%COMP%]{border:2px solid #fff;box-shadow:0 0 0 100vmax #00000080;content:"";display:block;left:50%;height:300px;position:absolute;top:50%;transform:translate(-50%,-50%);width:300px}.alert-message[_ngcontent-%COMP%]{outline:1px solid red!important}']}),e})()}];let v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[r.Bz.forChild(m)],r.Bz]}),e})(),w=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[s.ez,o.u5,i.Pc,u.JF,v]]}),e})()}}]);